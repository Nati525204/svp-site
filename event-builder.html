<!DOCTYPE html>
<html lang="he" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <title>×™×¦×™×¨×ª ××™×¨×•×¢ ×—×“×©</title>

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      body {
        min-height: 100vh;
        margin: 0;
        padding: 24px 18px 32px;
        background: radial-gradient(circle at top, #1d2a4a, #020617 55%, #000);
        font-family: "Heebo", system-ui, -apple-system, BlinkMacSystemFont,
          "Segoe UI", sans-serif;
        color: #e5e7eb;
        display: flex;
        justify-content: center;
      }

      .wrap {
        width: min(720px, 100%);
        background: rgba(15, 23, 42, 0.96);
        border-radius: 24px;
        padding: 22px 20px 24px;
        border: 1px solid rgba(148, 163, 184, 0.35);
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.6);
      }

      .top-nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 13px;
        color: #9ca3af;
        margin-bottom: 10px;
      }

      .top-nav a {
        color: #93c5fd;
        text-decoration: none;
      }

      h1 {
        margin: 0 0 6px;
        font-size: clamp(24px, 3vw, 30px);
        font-weight: 800;
      }

      .sub {
        color: #9ca3af;
        font-size: 14px;
        margin-bottom: 16px;
      }

      label {
        display: block;
        font-size: 14px;
        margin-bottom: 4px;
        font-weight: 600;
      }

      input,
      select,
      textarea {
        width: 100%;
        padding: 11px 12px;
        border-radius: 12px;
        border: 1px solid rgba(148, 163, 184, 0.7);
        background: #020617;
        color: #e5e7eb;
        font-size: 14px;
        margin-bottom: 10px;
        font-family: inherit;
      }

      textarea {
        min-height: 70px;
        resize: vertical;
      }

      select {
        cursor: pointer;
      }

      input::placeholder,
      textarea::placeholder {
        color: #6b7280;
      }

      .hint {
        font-size: 12px;
        color: #9ca3af;
        margin-top: -4px;
        margin-bottom: 8px;
      }

      .premium-box {
        margin-top: 8px;
        padding: 10px 12px 10px;
        border-radius: 16px;
        border: 1px solid rgba(251, 191, 36, 0.7);
        background: radial-gradient(circle at top, #451a03, #020617 65%);
        font-size: 13px;
      }

      .premium-box h3 {
        margin: 0 0 6px;
        font-size: 15px;
      }

      .btn-row {
        display: grid;
        gap: 6px;
        margin-top: 4px;
        margin-bottom: 8px;
      }

      .btn-row small {
        font-size: 11px;
        color: #e5e7eb;
      }

      button {
        width: 100%;
        padding: 12px;
        margin-top: 6px;
        border-radius: 999px;
        border: none;
        cursor: pointer;
        font-size: 15px;
        font-weight: 700;
        background: linear-gradient(135deg, #3b82f6, #1d4ed8);
        color: #f9fafb;
        box-shadow: 0 12px 30px rgba(37, 99, 235, 0.5);
        transition: transform 0.06s ease, box-shadow 0.15s ease;
      }

      button:active {
        transform: translateY(1px);
        box-shadow: none;
      }

      .box {
        background: #020617;
        border-radius: 16px;
        padding: 16px 14px 14px;
        margin-top: 20px;
        border: 1px solid rgba(148, 163, 184, 0.6);
        font-size: 14px;
      }

      .link-field {
        display: flex;
        gap: 8px;
        margin-top: 8px;
      }

      .link-field input {
        margin: 0;
        flex: 1;
        direction: ltr;
        font-size: 13px;
      }

      .link-field button {
        width: auto;
        padding-inline: 14px;
        box-shadow: none;
        background: #10b981;
        font-size: 13px;
      }

      .note {
        color: #9ca3af;
        font-size: 13px;
        margin-top: 8px;
      }

      footer {
        margin-top: 20px;
        font-size: 12px;
        color: #6b7280;
        text-align: center;
      }
    </style>
  </head>

  <body>
    <div class="wrap">
      <div class="top-nav">
        <span>ğŸ›  ×™×¦×™×¨×ª ××™×¨×•×¢</span>
        <div style="display:flex;gap:10px;">
          <a href="index.html">×“×£ ×”×‘×™×ª</a>
          <a href="landing.html">×—×‘×™×œ×•×ª</a>
          <a href="events.html">ğŸ“‹ × ×™×”×•×œ ××™×¨×•×¢×™×</a>
        </div>
      </div>

      <h1>×™×¦×™×¨×ª ××™×¨×•×¢ ×—×“×© ğŸ‰</h1>
      <div class="sub">××œ× ×›××” ×©×“×•×ª ×•× ×™×¦×•×¨ ×¢×‘×•×¨×š ×œ×™× ×§ ××•×›×Ÿ ×œ×©×œ×™×—×”.</div>

      <label>×©× ×”××™×¨×•×¢</label>
      <input id="title" placeholder="×œ××©×œ: ×—×ª×•× ×ª × ×ª×™ ×•×˜×œ" />

      <label>×ª××¨×™×š</label>
      <input id="date" placeholder="×œ××©×œ: 18.11.2025" />

      <label>××™×§×•×</label>
      <input id="loc" placeholder="×ª×œ ××‘×™×‘, ×™×’××œ ××œ×•×Ÿ 50 ×§×•××” 10" />

      <label>×¡×™×¡××ª ×× ×”×œ</label>
      <input id="admin" placeholder="×‘×—×¨ ×¡×™×¡××” (×¨×§ ×œ×š)" />

      <label>×—×‘×™×œ×” ×©× ×¨×›×©×”</label>
      <select id="tier">
        <option value="free">×—×™× × â€“ ×˜×•×¤×¡ ×‘×¡×™×¡×™</option>
        <option value="basic" selected>×‘×¡×™×¡×™ â€“ 49â‚ª</option>
        <option value="pro">××ª×§×“× â€“ 99â‚ª</option>
        <option value="premium">×¤×¨×™××™×•× â€“ 149â‚ª</option>
      </select>

      <div
        id="tierDetails"
        style="margin-bottom: 12px; font-size: 13px; color: #9ca3af"
      >
        ×—×‘×™×œ×” ×‘×¡×™×¡×™×ª â€“ 49â‚ª â€¢ ×˜×•×¤×¡ ××¢×•×¦×‘ + × ×™×”×•×œ ××™×©×•×¨×™ ×”×’×¢×”.
      </div>

      <!-- ××–×•×¨ ×”×’×“×¨×•×ª ×¤×¨×™××™×•× ×œ×××¨×— -->
      <div id="premiumConfig" class="premium-box" style="display:none;">
        <h3>ğŸ’ ×”×’×“×¨×•×ª ×¤×¨×™××™×•× â€“ ×ª×•×›×Ÿ ××•×ª×× ××™×©×™×ª</h3>
        <p class="hint">
          ×›××Ÿ ××ª×” ×§×•×‘×¢ ××™×š ×™×™×¨××” ×”××–×•×¨ ×”××™×•×—×“ ×‘×¤×¨×™××™×•×: ×˜×§×¡×˜ ×—×•×¤×©×™ ×•×›×¤×ª×•×¨×™×
          ×œ×§×™×©×•×¨×™× ×©×ª×¨×¦×” (×‘×™×˜, ××¤×”, ×ª×¤×¨×™×˜ ×•×¢×•×“).
        </p>

        <label>×›×•×ª×¨×ª ×œ××–×•×¨ ×”××™×•×—×“</label>
        <input
          id="csTitle"
          placeholder="×œ××©×œ: ××–×•×¨ ××ª× ×•×ª ×•×‘×¨×›×•×ª"
        />

        <label>×˜×§×¡×˜ ×œ××–×•×¨ ×”××™×•×—×“</label>
        <textarea
          id="csText"
          placeholder="×œ××©×œ: ×›××Ÿ ×ª×•×›×œ×• ×œ××¦×•× ×§×™×©×•×¨×™× ×œ××ª× ×”, ××™×§×•×, ×ª×¤×¨×™×˜ ×•×¢×•×“."
        ></textarea>

        <div class="btn-row">
          <small>×›×¤×ª×•×¨ 1 (×œ××©×œ: ××ª× ×” ×‘×‘×™×˜)</small>
          <input id="btn1Label" placeholder="×˜×§×¡×˜ ×›×¤×ª×•×¨ 1 â€“ ×œ××©×œ: ×©×œ×™×—×ª ××ª× ×”" />
          <input
            id="btn1Url"
            placeholder="×§×™×©×•×¨ ×›×¤×ª×•×¨ 1 â€“ ×œ××©×œ: ×œ×™× ×§ ×‘×™×˜ / ×¤×™×™×‘×•×§×¡ / ×“×£ ×ª×©×œ×•×"
          />

          <small>×›×¤×ª×•×¨ 2 (×œ××©×œ: ××™×§×•× ×‘××¤×œ×™×§×¦×™×”)</small>
          <input id="btn2Label" placeholder="×˜×§×¡×˜ ×›×¤×ª×•×¨ 2 â€“ ×œ××©×œ: ××™×§×•× ×”××™×¨×•×¢" />
          <input
            id="btn2Url"
            placeholder="×§×™×©×•×¨ ×›×¤×ª×•×¨ 2 â€“ ×œ××©×œ: Google Maps / Waze"
          />

          <small>×›×¤×ª×•×¨ 3 (××•×¤×¦×™×•× ×œ×™)</small>
          <input id="btn3Label" placeholder="×˜×§×¡×˜ ×›×¤×ª×•×¨ 3" />
          <input id="btn3Url" placeholder="×§×™×©×•×¨ ×›×¤×ª×•×¨ 3" />
        </div>

        <label>×§×™×©×•×¨ ×‘×™×˜ ×œ××ª× ×” (×œ××–×•×¨ ×”××ª× ×” ×‘×¤×¨×™××™×•×)</label>
        <input
          id="giftBit"
          placeholder="×œ××©×œ: ×§×™×©×•×¨ ×©×™×ª×•×£ ××ª× ×” ××”××¤×œ×™×§×¦×™×” ×©×œ ×‘×™×˜"
        />
        <div class="hint">
          ×× ×ª××œ× ×›××Ÿ ×§×™×©×•×¨, ×›×¤×ª×•×¨ "×©×œ×™×—×ª ××ª× ×” ×‘×‘×™×˜" ×‘×“×£ ×”×”×–×× ×” ×™×™×¤×ª×— ××ª ×”×§×™×©×•×¨
          ×”×–×”.
        </div>
      </div>

      <button id="make">×¦×•×¨ ××™×¨×•×¢</button>

      <div id="output" class="box" style="display: none"></div>

      <footer>×™×•×¦×¨ ×”××¢×¨×›×ª: × ×ª× ××œ ×‘×Ÿ ×—×™×™× â€¢ ×›×œ ×”×–×›×•×™×•×ª ×©××•×¨×•×ª Â©</footer>
    </div>

    <script>
      const makeBtn = document.getElementById("make");
      const output = document.getElementById("output");
      const tierSelect = document.getElementById("tier");
      const tierDetails = document.getElementById("tierDetails");
      const premiumConfig = document.getElementById("premiumConfig");

      // ××•×ª×• KEY ×›××• ×‘-events.html
      const STORAGE_KEY = "invitepro_events_v1";

      const tierDescriptions = {
        free: "×—×‘×™×œ×ª ×—×™× × â€“ ×˜×•×¤×¡ ×‘×¡×™×¡×™ ×œ××™×©×•×¨ ×”×’×¢×”.",
        basic: "×—×‘×™×œ×” ×‘×¡×™×¡×™×ª â€“ 49â‚ª â€¢ ×˜×•×¤×¡ ××¢×•×¦×‘ + × ×™×”×•×œ ××™×©×•×¨×™ ×”×’×¢×”.",
        pro: "×—×‘×™×œ×” ××ª×§×“××ª â€“ 99â‚ª â€¢ ×›×•×œ×œ ×œ×•×— × ×™×”×•×œ ××œ× + ×™×™×¦×•× ×œ××§×¡×œ.",
        premium:
          "×—×‘×™×œ×ª ×¤×¨×™××™×•× â€“ 149â‚ª â€¢ ×¢×™×¦×•×‘ ×™×•×§×¨×ª×™, ××–×•×¨ ××•×ª×× ××™×©×™×ª, ×œ×•×— × ×™×”×•×œ, ×™×™×¦×•× ×œ××§×¡×œ ×•×ª××™×›×” ×¢×“ ×”××™×¨×•×¢.",
      };

      // ×§×¨×™××ª tier ×•-paid ××”-URL
      const params = new URLSearchParams(location.search);
      const urlTier = params.get("tier");
      const paidFlag = params.get("paid");

      if (urlTier && tierDescriptions[urlTier]) {
        tierSelect.value = urlTier;
      }

      function updateTierDetails() {
        const tier = tierSelect.value || "basic";
        tierDetails.textContent = tierDescriptions[tier] || "";

        // ×¨×§ ×‘×¤×¨×™××™×•× â€“ ××¦×™×’×™× ××ª ×”×’×“×¨×•×ª ×”×¤×¨×™××™×•×
        if (tier === "premium") {
          premiumConfig.style.display = "block";
        } else {
          premiumConfig.style.display = "none";
        }
      }

      tierSelect.addEventListener("change", updateTierDetails);
      updateTierDetails();

      // ğŸ”’ ×× ×¢×•×œ: ×—×‘×™×œ×•×ª ×‘×ª×©×œ×•× ××—×™×™×‘×•×ª ××¢×‘×¨ ×“×¨×š payment.html
      if (tierSelect.value !== "free" && paidFlag !== "ok") {
        alert("×›×“×™ ×œ×™×¦×•×¨ ××™×¨×•×¢ ×‘×—×‘×™×œ×” ×‘×ª×©×œ×•×, ×¦×¨×™×š ×œ×¢×‘×•×¨ ×§×•×“× ×“×¨×š ×“×£ ×”×ª×©×œ×•×.");
        location.href = `payment.html?tier=${tierSelect.value}`;
      }

      function loadEvents() {
        try {
          const raw = localStorage.getItem(STORAGE_KEY);
          if (!raw) return [];
          const arr = JSON.parse(raw);
          if (!Array.isArray(arr)) return [];
          return arr;
        } catch (e) {
          console.error("Load events error", e);
          return [];
        }
      }

      function saveEvents(list) {
        try {
          localStorage.setItem(STORAGE_KEY, JSON.stringify(list));
        } catch (e) {
          console.error("Save events error", e);
        }
      }

      makeBtn.addEventListener("click", () => {
        const title = document.getElementById("title").value.trim();
        const date = document.getElementById("date").value.trim();
        const loc =
          document.getElementById("loc").value.trim() ||
          "×ª×œ ××‘×™×‘, ×™×’××œ ××œ×•×Ÿ 50 ×§×•××” 10";
        const admin = document.getElementById("admin").value.trim();
        const tier = tierSelect.value;

        if (!title || !date || !admin) {
          alert("××œ× ××ª ×›×œ ×”×©×“×•×ª (×©× ××™×¨×•×¢, ×ª××¨×™×š, ×¡×™×¡××”)");
          return;
        }

        // ×¢×¨×›×™ ×¤×¨×™××™×•× â€“ ×¨×§ ×× ×”×—×‘×™×œ×” ×”×™× ×¤×¨×™××™×•×
        let csTitle = "";
        let csText = "";
        let btn1Label = "";
        let btn1Url = "";
        let btn2Label = "";
        let btn2Url = "";
        let btn3Label = "";
        let btn3Url = "";
        let giftBit = "";

        if (tier === "premium") {
          csTitle = document.getElementById("csTitle").value.trim();
          csText = document.getElementById("csText").value.trim();
          btn1Label = document.getElementById("btn1Label").value.trim();
          btn1Url = document.getElementById("btn1Url").value.trim();
          btn2Label = document.getElementById("btn2Label").value.trim();
          btn2Url = document.getElementById("btn2Url").value.trim();
          btn3Label = document.getElementById("btn3Label").value.trim();
          btn3Url = document.getElementById("btn3Url").value.trim();
          giftBit = document.getElementById("giftBit").value.trim();
        }

        const event_id = crypto.randomUUID
          ? crypto.randomUUID()
          : String(Date.now()) + String(Math.random());

        // ×‘×¡×™×¡ ×”-URL ×©×œ ×”××ª×¨
        const base =
          location.origin + location.pathname.replace(/[^/]+$/, "");

        // ×‘×•× ×™× ×§×™×©×•×¨ ×¢× URLSearchParams ×›×“×™ ×©×™×”×™×” × ×§×™
        const url = new URL(base + "rsvp.html");
        url.searchParams.set("event_id", event_id);
        url.searchParams.set("title", title);
        url.searchParams.set("date", date);
        url.searchParams.set("loc", loc);
        url.searchParams.set("admin_pwd", admin);
        url.searchParams.set("tier", tier);

        if (tier === "premium") {
          if (csTitle) url.searchParams.set("cs_title", csTitle);
          if (csText) url.searchParams.set("cs_text", csText);
          if (btn1Label) url.searchParams.set("btn1_label", btn1Label);
          if (btn1Url) url.searchParams.set("btn1_url", btn1Url);
          if (btn2Label) url.searchParams.set("btn2_label", btn2Label);
          if (btn2Url) url.searchParams.set("btn2_url", btn2Url);
          if (btn3Label) url.searchParams.set("btn3_label", btn3Label);
          if (btn3Url) url.searchParams.set("btn3_url", btn3Url);
          if (giftBit) url.searchParams.set("gift_bit", giftBit);
        }

        const fullLink = url.toString();

        const tierLabel =
          tier === "free"
            ? "×—×™× ×"
            : tier === "basic"
            ? "×‘×¡×™×¡×™ â€“ 49â‚ª"
            : tier === "pro"
            ? "××ª×§×“× â€“ 99â‚ª"
            : "×¤×¨×™××™×•× â€“ 149â‚ª";

        // ×©××™×¨×” ××•×˜×•××˜×™×ª ×œ-events.html
        try {
          const events = loadEvents();
          events.push({
            id: event_id,
            title,
            date,
            link: fullLink,
            tier,
            createdAt: new Date().toISOString(),
          });
          saveEvents(events);
        } catch (e) {
          console.error("Error saving event to localStorage", e);
        }

        output.style.display = "block";
        output.innerHTML = `
          <h3>×”×œ×™× ×§ ×©× ×•×¦×¨:</h3>
          <div class="link-field">
            <input id="eventLink" value="${fullLink}" readonly onclick="this.select()" />
            <button id="copyBtn">×”×¢×ª×§</button>
          </div>
          <div class="note">
            ×©×œ×— ××ª ×”×œ×™× ×§ ×”×–×” ×œ××•×–×× ×™×. ×‘×¡×•×£ ×”×“×£ ×™×© ×›×¤×ª×•×¨ "×œ×•×— × ×™×”×•×œ"
            ×¢× ×¡×™×¡××ª ×”×× ×”×œ ×©×‘×—×¨×ª.<br/>
            <strong>×—×‘×™×œ×” ×©× ×‘×—×¨×”:</strong> ${tierLabel}<br/>
            ×”××™×¨×•×¢ × ×•×¡×£ ××•×˜×•××˜×™×ª ×’× ×œ××¡×š <strong>"× ×™×”×•×œ ××™×¨×•×¢×™×"</strong>.
          </div>
        `;

        const copyBtn = document.getElementById("copyBtn");
        copyBtn.addEventListener("click", async () => {
          const inp = document.getElementById("eventLink");
          inp.select();
          try {
            await navigator.clipboard.writeText(inp.value);
            copyBtn.textContent = "×”×•×¢×ª×§ âœ”";
            setTimeout(() => (copyBtn.textContent = "×”×¢×ª×§"), 1500);
          } catch {
            document.execCommand("copy");
            copyBtn.textContent = "×”×•×¢×ª×§ âœ”";
            setTimeout(() => (copyBtn.textContent = "×”×¢×ª×§"), 1500);
          }
        });
      });
    </script>
  </body>
</html>