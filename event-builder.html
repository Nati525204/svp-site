<!DOCTYPE html>
<html lang="he" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>×™×¦×™×¨×ª ××™×¨×•×¢ ×—×“×©</title>

    <style>
      body {
        min-height: 100vh;
        margin: 0;
        padding: 24px 18px 32px;
        background: radial-gradient(circle at top, #1d2a4a, #020617 55%, #000);
        font-family: "Heebo", system-ui, -apple-system, BlinkMacSystemFont,
          "Segoe UI", sans-serif;
        color: #e5e7eb;
        display: flex;
        justify-content: center;
      }

      .wrap {
        width: min(720px, 100%);
        background: rgba(15, 23, 42, 0.96);
        border-radius: 24px;
        padding: 22px 20px 24px;
        border: 1px solid rgba(148, 163, 184, 0.35);
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.6);
      }

      .top-nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 13px;
        color: #9ca3af;
        margin-bottom: 10px;
      }

      .top-nav a {
        color: #93c5fd;
        text-decoration: none;
      }

      h1 {
        margin: 0 0 6px;
        font-size: clamp(24px, 3vw, 30px);
        font-weight: 800;
      }

      .sub {
        color: #9ca3af;
        font-size: 14px;
        margin-bottom: 16px;
      }

      label {
        display: block;
        font-size: 14px;
        margin-bottom: 4px;
        font-weight: 600;
      }

      input,
      select {
        width: 100%;
        padding: 11px 12px;
        border-radius: 12px;
        border: 1px solid rgba(148, 163, 184, 0.7);
        background: #020617;
        color: #e5e7eb;
        font-size: 15px;
        margin-bottom: 12px;
      }

      select {
        cursor: pointer;
      }

      input::placeholder {
        color: #6b7280;
      }

      .paid-row {
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 13px;
        margin-top: -6px;
        margin-bottom: 10px;
      }

      .paid-row input[type="checkbox"] {
        width: 18px;
        height: 18px;
        accent-color: #22c55e;
      }

      button {
        width: 100%;
        padding: 12px;
        margin-top: 4px;
        border-radius: 999px;
        border: none;
        cursor: pointer;
        font-size: 15px;
        font-weight: 700;
        background: linear-gradient(135deg, #3b82f6, #1d4ed8);
        color: #f9fafb;
        box-shadow: 0 12px 30px rgba(37, 99, 235, 0.5);
        transition: transform 0.06s ease, box-shadow 0.15s ease;
      }

      button:active {
        transform: translateY(1px);
        box-shadow: none;
      }

      .box {
        background: #020617;
        border-radius: 16px;
        padding: 16px 14px 14px;
        margin-top: 20px;
        border: 1px solid rgba(148, 163, 184, 0.6);
        font-size: 14px;
      }

      .link-field {
        display: flex;
        gap: 8px;
        margin-top: 8px;
      }

      .link-field input {
        margin: 0;
        flex: 1;
        direction: ltr;
        font-size: 13px;
      }

      .link-field button {
        width: auto;
        padding-inline: 14px;
        box-shadow: none;
        background: #10b981;
        font-size: 13px;
      }

      .note {
        color: #9ca3af;
        font-size: 13px;
        margin-top: 8px;
      }

      footer {
        margin-top: 20px;
        font-size: 12px;
        color: #6b7280;
        text-align: center;
      }
    </style>
  </head>

  <body>
    <div class="wrap">
      <div class="top-nav">
        <span>ğŸ›  ×™×¦×™×¨×ª ××™×¨×•×¢</span>
        <div style="display:flex;gap:10px;">
          <a href="index.html">×“×£ ×”×‘×™×ª</a>
          <a href="landing.html">×—×‘×™×œ×•×ª</a>
          <a href="events.html">ğŸ“‹ × ×™×”×•×œ ××™×¨×•×¢×™×</a>
        </div>
      </div>

      <h1>×™×¦×™×¨×ª ××™×¨×•×¢ ×—×“×© ğŸ‰</h1>
      <div class="sub">××œ× ×›××” ×©×“×•×ª ×•× ×™×¦×•×¨ ×¢×‘×•×¨×š ×œ×™× ×§ ××•×›×Ÿ ×œ×©×œ×™×—×”.</div>

      <label>×©× ×”××™×¨×•×¢</label>
      <input id="title" placeholder="×œ××©×œ: ×¢×¨×‘ ×‘×©×¨×™×" />

      <label>×ª××¨×™×š</label>
      <input id="date" placeholder="×œ××©×œ: 18.11.2025" />

      <label>××™×§×•×</label>
      <input id="loc" placeholder="×ª×œ ××‘×™×‘, ×™×’××œ ××œ×•×Ÿ 50 ×§×•××” 10" />

      <label>×¡×™×¡××ª ×× ×”×œ</label>
      <input id="admin" placeholder="×‘×—×¨ ×¡×™×¡××” (×¨×§ ×œ×š)" />

      <label>×—×‘×™×œ×” ×©× ×¨×›×©×”</label>
      <select id="tier">
        <option value="free">×—×™× × â€“ ×˜×•×¤×¡ ×‘×¡×™×¡×™</option>
        <option value="basic" selected>×‘×¡×™×¡×™ â€“ 49â‚ª</option>
        <option value="pro">××ª×§×“× â€“ 99â‚ª</option>
        <option value="premium">×¤×¨×™××™×•× â€“ 149â‚ª</option>
      </select>

      <div
        id="tierDetails"
        style="margin-bottom: 12px; font-size: 13px; color: #9ca3af"
      >
        ×—×‘×™×œ×” ×‘×¡×™×¡×™×ª â€“ 49â‚ª â€¢ ×˜×•×¤×¡ ××¢×•×¦×‘ + × ×™×”×•×œ ××™×©×•×¨×™ ×”×’×¢×”.
      </div>

      <div class="paid-row">
        <input id="paidConfirm" type="checkbox" />
        <label for="paidConfirm">×× ×™ ×××©×¨/×ª ×©×©×™×œ××ª×™ ×¢×‘×•×¨ ×”×—×‘×™×œ×”.</label>
      </div>

      <button id="make">×¦×•×¨ ××™×¨×•×¢</button>

      <div id="output" class="box" style="display: none"></div>

      <footer>×™×•×¦×¨ ×”××¢×¨×›×ª: × ×ª× ××œ ×‘×Ÿ ×—×™×™× â€¢ ×›×œ ×”×–×›×•×™×•×ª ×©××•×¨×•×ª Â©</footer>
    </div>

    <script>
      const makeBtn = document.getElementById("make");
      const output = document.getElementById("output");
      const tierSelect = document.getElementById("tier");
      const paidConfirm = document.getElementById("paidConfirm");
      const tierDetails = document.getElementById("tierDetails");

      // ××•×ª×• KEY ×›××• ×‘-events.html
      const STORAGE_KEY = "invitepro_events_v1";

      const tierDescriptions = {
        free: "×—×‘×™×œ×ª ×—×™× × â€“ ×˜×•×¤×¡ ×‘×¡×™×¡×™ ×œ××™×©×•×¨ ×”×’×¢×”.",
        basic: "×—×‘×™×œ×” ×‘×¡×™×¡×™×ª â€“ 49â‚ª â€¢ ×˜×•×¤×¡ ××¢×•×¦×‘ + × ×™×”×•×œ ××™×©×•×¨×™ ×”×’×¢×”.",
        pro: "×—×‘×™×œ×” ××ª×§×“××ª â€“ 99â‚ª â€¢ ×›×•×œ×œ ×œ×•×— × ×™×”×•×œ ××œ× + ×™×™×¦×•× ×œ××§×¡×œ.",
        premium:
          "×—×‘×™×œ×ª ×¤×¨×™××™×•× â€“ 149â‚ª â€¢ ×¢×™×¦×•×‘ ×™×•×§×¨×ª×™, ×œ×•×— × ×™×”×•×œ, ×™×™×¦×•× ×œ××§×¡×œ ×•×ª××™×›×” ×¢×“ ×”××™×¨×•×¢.",
      };

      // ×§×¨×™××ª tier ××”-URL (×× ×”×’×™×¢×• ×-landing ×¢× ?tier=...)
      const params = new URLSearchParams(location.search);
      const urlTier = params.get("tier");
      if (urlTier && tierDescriptions[urlTier]) {
        tierSelect.value = urlTier;
      }

      function updateTierDetails() {
        const tier = tierSelect.value || "basic";
        tierDetails.textContent = tierDescriptions[tier] || "";
      }

      tierSelect.addEventListener("change", updateTierDetails);
      // ×¢×“×›×•×Ÿ ×¨××©×•× ×™
      updateTierDetails();

      function loadEvents() {
        try {
          const raw = localStorage.getItem(STORAGE_KEY);
          if (!raw) return [];
          const arr = JSON.parse(raw);
          if (!Array.isArray(arr)) return [];
          return arr;
        } catch (e) {
          console.error("Load events error", e);
          return [];
        }
      }

      function saveEvents(list) {
        try {
          localStorage.setItem(STORAGE_KEY, JSON.stringify(list));
        } catch (e) {
          console.error("Save events error", e);
        }
      }

      makeBtn.addEventListener("click", () => {
        const title = document.getElementById("title").value.trim();
        const date = document.getElementById("date").value.trim();
        const loc =
          document.getElementById("loc").value.trim() ||
          "×ª×œ ××‘×™×‘, ×™×’××œ ××œ×•×Ÿ 50 ×§×•××” 10";
        const admin = document.getElementById("admin").value.trim();
        const tier = tierSelect.value;

        if (!title || !date || !admin) {
          alert("××œ× ××ª ×›×œ ×”×©×“×•×ª (×©× ××™×¨×•×¢, ×ª××¨×™×š, ×¡×™×¡××”)");
          return;
        }

        // ××œ×‘×“ ×—×™× × â€“ ×—×™×™×‘ ×¡×™××•×Ÿ ×ª×©×œ×•×
        if (tier !== "free" && !paidConfirm.checked) {
          alert("×¡××Ÿ/×™ ×©×©×™×œ××ª ×¢×‘×•×¨ ×”×—×‘×™×œ×” ×©×‘×—×¨×ª.");
          return;
        }

        const event_id = crypto.randomUUID
          ? crypto.randomUUID()
          : String(Date.now()) + String(Math.random());

        // ×‘×¡×™×¡ ×”-URL ×©×œ ×”××ª×¨
        const base =
          location.origin + location.pathname.replace(/[^/]+$/, "");

        const fullLink = `${base}rsvp.html?event_id=${event_id}&title=${encodeURIComponent(
          title
        )}&date=${encodeURIComponent(date)}&loc=${encodeURIComponent(
          loc
        )}&admin_pwd=${encodeURIComponent(admin)}&tier=${tier}`;

        const tierLabel =
          tier === "free"
            ? "×—×™× ×"
            : tier === "basic"
            ? "×‘×¡×™×¡×™ â€“ 49â‚ª"
            : tier === "pro"
            ? "××ª×§×“× â€“ 99â‚ª"
            : "×¤×¨×™××™×•× â€“ 149â‚ª";

        // ğŸ” ×©××™×¨×” ××•×˜×•××˜×™×ª ×œ-events.html (localStorage)
        try {
          const events = loadEvents();
          events.push({
            id: event_id,
            title,
            date,
            link: fullLink,
            tier,
            createdAt: new Date().toISOString(),
          });
          saveEvents(events);
          console.log("Event saved to localStorage");
        } catch (e) {
          console.error("Error saving event to localStorage", e);
        }

        output.style.display = "block";
        output.innerHTML = `
          <h3>×”×œ×™× ×§ ×©× ×•×¦×¨:</h3>
          <div class="link-field">
            <input id="eventLink" value="${fullLink}" readonly onclick="this.select()" />
            <button id="copyBtn">×”×¢×ª×§</button>
          </div>
          <div class="note">
            ×©×œ×— ××ª ×”×œ×™× ×§ ×”×–×” ×œ××•×–×× ×™×. ×‘×¡×•×£ ×”×“×£ ×™×© ×›×¤×ª×•×¨ "×œ×•×— × ×™×”×•×œ"
            ×¢× ×¡×™×¡××ª ×”×× ×”×œ ×©×‘×—×¨×ª.<br/>
            <strong>×—×‘×™×œ×” ×©× ×‘×—×¨×”:</strong> ${tierLabel}<br/>
            ×”××™×¨×•×¢ × ×•×¡×£ ××•×˜×•××˜×™×ª ×’× ×œ××¡×š <strong>"× ×™×”×•×œ ××™×¨×•×¢×™×"</strong>.
          </div>
        `;

        const copyBtn = document.getElementById("copyBtn");
        copyBtn.addEventListener("click", async () => {
          const inp = document.getElementById("eventLink");
          inp.select();
          try {
            await navigator.clipboard.writeText(inp.value);
            copyBtn.textContent = "×”×•×¢×ª×§ âœ”";
            setTimeout(() => (copyBtn.textContent = "×”×¢×ª×§"), 1500);
          } catch {
            document.execCommand("copy");
            copyBtn.textContent = "×”×•×¢×ª×§ âœ”";
            setTimeout(() => (copyBtn.textContent = "×”×¢×ª×§"), 1500);
          }
        });
      });
    </script>
  </body>
</html>